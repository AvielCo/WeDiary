<div
  class="modal fade"
  id="guestsModal"
  tabindex="-1"
  aria-labelledby="guestsModal"
  aria-hidden="true"
>
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">
          <span> Guests </span>
        </h5>

        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
          (click)="toggleModal()"
        ></button>
      </div>
      <div class="modal-body">
        <!-- Action buttons -->
        <!-- Add button will add another guest to the table in edit mode -->
        <button class="btn">
          <i class="bi bi-plus-square"></i>
          Add
        </button>

        <!-- This will be active when selected row is not -1 (a row is selected)
              AND the edit button has not been clicked -->
        <ng-template [ngIf]="selectedRow != -1 && activeEditRow == -1">
          <!-- Edit button will be visible only if a guest is marked (with radio button) -->
          <button
            class="btn me-1"
            data-bs-toggle="tooltip"
            data-bs-placement="top"
            title="Edit guest"
            (click)="toggleEditGuest(selectedRow)"
          >
            <i class="bi bi-pencil-square"></i>
            Edit
          </button>
          <!-- Remove button will be visible only if a guest is marked (with radio button) -->
          <button
            class="btn"
            data-bs-toggle="tooltip"
            data-bs-placement="top"
            title="Remove guest"
          >
            <i class="bi bi-trash"></i>
            Delete
          </button>
        </ng-template>

        <!-- This will be active ONLY when edit button has been clicked -->
        <ng-template [ngIf]="activeEditRow != -1">
          <button
            class="btn me-1"
            data-bs-toggle="tooltip"
            data-bs-placement="top"
            title="Save changes"
            (click)="saveGuestChanges(selectedRow)"
          >
            <i class="bi bi-check2-square"></i>
            Save
          </button>
          <button
            class="btn"
            data-bs-toggle="tooltip"
            data-bs-placement="top"
            title="Cancel changes"
            (click)="toggleEditGuest(-1)"
          >
            <i class="bi bi-x-square"></i>
            Cancel
          </button>
        </ng-template>

        <div
          *ngIf="isLoading || !guestsList"
          class="d-flex justify-content-center"
        >
          <div class="spinner-border m-5" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
        </div>
        <div *ngIf="guestsList && guestsList.length == 0 && !isLoading">
          List is empty
        </div>
        <div
          class="table-responsive"
          *ngIf="guestsList && guestsList.length > 0 && !isLoading"
        >
          <table class="table table-hover table-borderless">
            <thead>
              <tr>
                <td></td>
                <td>Name</td>
                <td>Comment</td>
                <td class="text-right">How many</td>
                <td class="text-right">Gifted</td>
              </tr>
            </thead>
            <tbody>
              <!-- Content of the table -->
              <tr *ngFor="let guest of guestsList; let i = index">
                <td scope="row">
                  <input
                    class="form-check-input"
                    type="radio"
                    name="selectedRowRadio"
                    id="selectedRowRadio"
                    (input)="changeSelectedRow(i)"
                  />
                </td>
                <ng-container
                  *ngIf="
                    activeEditRow != i;
                    then editModeDeactivated;
                    else editModeActivated
                  "
                ></ng-container>
                <ng-template #editModeDeactivated>
                  <td>{{ guest.name }}</td>
                  <td>{{ guest.comment }}</td>
                  <td class="text-right">{{ guest.howMany }}</td>
                  <td class="text-right">{{ guest.howMuch }}</td>
                </ng-template>
                <ng-template #editModeActivated>
                  <td>
                    <span class="input-wrap">
                      <span class="width-machine" aria-hidden="true">{{
                        guest.name
                      }}</span>
                      <input
                        class="input"
                        type="text"
                        value="{{ guest.name }}"
                        name="name"
                        (input)="onChange($event)"
                      />
                    </span>
                  </td>
                  <td>
                    <textarea
                      placeholder="Write a comment"
                      name="comment"
                      [value]="guest.comment"
                      (input)="onChange($event)"
                    ></textarea>
                  </td>
                  <td class="text-right">
                    <span class="input-wrap">
                      <span class="width-machine" aria-hidden="true">{{
                        guest.howMany
                      }}</span>
                      <input
                        class="input number"
                        type="number"
                        value="{{ guest.howMany }}"
                        name="howMany"
                        (input)="onChange($event)"
                      />
                    </span>
                  </td>
                  <td class="text-right">
                    <span class="input-wrap">
                      <span class="width-machine" aria-hidden="true">{{
                        guest.howMuch
                      }}</span>
                      <input
                        class="input number"
                        type="number"
                        value="{{ guest.howMuch }}"
                        name="howMuch"
                        (input)="onChange($event)"
                      />
                    </span>
                  </td>
                </ng-template>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="modal-footer"></div>
      </div>
    </div>
  </div>
</div>

<!-- 

  <button
                      class="btn me-1"
                      data-bs-toggle="tooltip"
                      data-bs-placement="top"
                      title="Save changes"
                      (click)="saveGuestChanges(i)"
                    >
                      <i class="bi bi-check2-square"></i>
                    </button>
                    <button
                      class="btn"
                      data-bs-toggle="tooltip"
                      data-bs-placement="top"
                      title="Cancel edit"
                      (click)="toggleEditGuest(-1)"
                    >
                      <i class="bi bi-x-square"></i>
                    </button>





                    

 -->
